import React, { Component } from 'react';
import { Spring, animated } from 'react-spring/renderprops';
import { GradientPinkRed as Gradient } from '@vx/gradient';
import * as easings from 'd3-ease';

export class App extends Component {
  state = { offset: 0 };
  path = React.createRef();
  componentDidMount() {
    console.log('MOUNTED');
    this.setState({ offset: this.path.current.getTotalLength() });
  }
  repeat = () => {
    this.forceUpdate();
  };
  render() {
    const { offset } = this.state;
    return (
      <div
        style={{
          background: '#272727',
          width: '100%',
          height: '100%',
          display: 'flex',
          justifyContent: 'center',
          alignItems: 'center',
        }}
        onClick={() => this.forceUpdate()}
      >
        <svg width="650" viewBox="0 -7 100 40">
          <Gradient id="gradient-dashoffset" />
          <g fill="#373737" stroke="url(#gradient-dashoffset)" strokeWidth="0.5">
            <Spring
              // native
              reset
              from={{ dash: offset }}
              to={{ dash: 0 }}
              config={{
                delay: 1000,
                duration: 3000,
                easing: easings.easeCubic,
              }}
              onRest={this.repeat}
            >
              {(props) => {
                return (
                  <animated.path
                    ref={this.path}
                    strokeDasharray={offset}
                    strokeDashoffset={props.dash}
                    d="M3.23047 11.3203V18H0.980469V0.9375H7.27344C9.14062 0.9375 10.6016 1.41406 11.6562 2.36719C12.7188 3.32031 13.25 4.58203 13.25 6.15234C13.25 7.80859 12.7305 9.08594 11.6914 9.98438C10.6602 10.875 9.17969 11.3203 7.25 11.3203H3.23047ZM3.23047 9.48047H7.27344C8.47656 9.48047 9.39844 9.19922 10.0391 8.63672C10.6797 8.06641 11 7.24609 11 6.17578C11 5.16016 10.6797 4.34766 10.0391 3.73828C9.39844 3.12891 8.51953 2.8125 7.40234 2.78906H3.23047V9.48047ZM22.3789 11.0977H18.3711V18H16.1094V0.9375H21.7578C23.6797 0.9375 25.1562 1.375 26.1875 2.25C27.2266 3.125 27.7461 4.39844 27.7461 6.07031C27.7461 7.13281 27.457 8.05859 26.8789 8.84766C26.3086 9.63672 25.5117 10.2266 24.4883 10.6172L28.4961 17.8594V18H26.082L22.3789 11.0977ZM18.3711 9.25781H21.8281C22.9453 9.25781 23.832 8.96875 24.4883 8.39062C25.1523 7.8125 25.4844 7.03906 25.4844 6.07031C25.4844 5.01562 25.168 4.20703 24.5352 3.64453C23.9102 3.08203 23.0039 2.79688 21.8164 2.78906H18.3711V9.25781ZM29.9961 11.543C29.9961 10.3008 30.2383 9.18359 30.7227 8.19141C31.2148 7.19922 31.8945 6.43359 32.7617 5.89453C33.6367 5.35547 34.6328 5.08594 35.75 5.08594C37.4766 5.08594 38.8711 5.68359 39.9336 6.87891C41.0039 8.07422 41.5391 9.66406 41.5391 11.6484V11.8008C41.5391 13.0352 41.3008 14.1445 40.8242 15.1289C40.3555 16.1055 39.6797 16.8672 38.7969 17.4141C37.9219 17.9609 36.9141 18.2344 35.7734 18.2344C34.0547 18.2344 32.6602 17.6367 31.5898 16.4414C30.5273 15.2461 29.9961 13.6641 29.9961 11.6953V11.543ZM32.1758 11.8008C32.1758 13.207 32.5 14.3359 33.1484 15.1875C33.8047 16.0391 34.6797 16.4648 35.7734 16.4648C36.875 16.4648 37.75 16.0352 38.3984 15.1758C39.0469 14.3086 39.3711 13.0977 39.3711 11.543C39.3711 10.1523 39.0391 9.02734 38.375 8.16797C37.7188 7.30078 36.8438 6.86719 35.75 6.86719C34.6797 6.86719 33.8164 7.29297 33.1602 8.14453C32.5039 8.99609 32.1758 10.2148 32.1758 11.8008ZM43.7422 11.5547C43.7422 9.57812 44.1992 8.00781 45.1133 6.84375C46.0273 5.67188 47.2383 5.08594 48.7461 5.08594C50.293 5.08594 51.5 5.63281 52.3672 6.72656L52.4727 5.32031H54.4531V17.6953C54.4531 19.3359 53.9648 20.6289 52.9883 21.5742C52.0195 22.5195 50.7148 22.9922 49.0742 22.9922C48.1602 22.9922 47.2656 22.7969 46.3906 22.4062C45.5156 22.0156 44.8477 21.4805 44.3867 20.8008L45.5117 19.5C46.4414 20.6484 47.5781 21.2227 48.9219 21.2227C49.9766 21.2227 50.7969 20.9258 51.3828 20.332C51.9766 19.7383 52.2734 18.9023 52.2734 17.8242V16.7344C51.4062 17.7344 50.2227 18.2344 48.7227 18.2344C47.2383 18.2344 46.0352 17.6367 45.1133 16.4414C44.1992 15.2461 43.7422 13.6172 43.7422 11.5547ZM45.9219 11.8008C45.9219 13.2305 46.2148 14.3555 46.8008 15.1758C47.3867 15.9883 48.207 16.3945 49.2617 16.3945C50.6289 16.3945 51.6328 15.7734 52.2734 14.5312V8.74219C51.6094 7.53125 50.6133 6.92578 49.2852 6.92578C48.2305 6.92578 47.4062 7.33594 46.8125 8.15625C46.2188 8.97656 45.9219 10.1914 45.9219 11.8008ZM57.1602 11.543C57.1602 10.3008 57.4023 9.18359 57.8867 8.19141C58.3789 7.19922 59.0586 6.43359 59.9258 5.89453C60.8008 5.35547 61.7969 5.08594 62.9141 5.08594C64.6406 5.08594 66.0352 5.68359 67.0977 6.87891C68.168 8.07422 68.7031 9.66406 68.7031 11.6484V11.8008C68.7031 13.0352 68.4648 14.1445 67.9883 15.1289C67.5195 16.1055 66.8438 16.8672 65.9609 17.4141C65.0859 17.9609 64.0781 18.2344 62.9375 18.2344C61.2188 18.2344 59.8242 17.6367 58.7539 16.4414C57.6914 15.2461 57.1602 13.6641 57.1602 11.6953V11.543ZM59.3398 11.8008C59.3398 13.207 59.6641 14.3359 60.3125 15.1875C60.9688 16.0391 61.8438 16.4648 62.9375 16.4648C64.0391 16.4648 64.9141 16.0352 65.5625 15.1758C66.2109 14.3086 66.5352 13.0977 66.5352 11.543C66.5352 10.1523 66.2031 9.02734 65.5391 8.16797C64.8828 7.30078 64.0078 6.86719 62.9141 6.86719C61.8438 6.86719 60.9805 7.29297 60.3242 8.14453C59.668 8.99609 59.3398 10.2148 59.3398 11.8008ZM75.418 15.0586L78.5586 5.32031H80.7734L76.2266 18H74.5742L69.9805 5.32031H72.1953L75.418 15.0586ZM85.2148 18H83.0469V5.32031H85.2148V18ZM82.8711 1.95703C82.8711 1.60547 82.9766 1.30859 83.1875 1.06641C83.4062 0.824219 83.7266 0.703125 84.1484 0.703125C84.5703 0.703125 84.8906 0.824219 85.1094 1.06641C85.3281 1.30859 85.4375 1.60547 85.4375 1.95703C85.4375 2.30859 85.3281 2.60156 85.1094 2.83594C84.8906 3.07031 84.5703 3.1875 84.1484 3.1875C83.7266 3.1875 83.4062 3.07031 83.1875 2.83594C82.9766 2.60156 82.8711 2.30859 82.8711 1.95703ZM90.7461 5.32031L90.8164 6.91406C91.7852 5.69531 93.0508 5.08594 94.6133 5.08594C97.293 5.08594 98.6445 6.59766 98.668 9.62109V18H96.5V9.60938C96.4922 8.69531 96.2812 8.01953 95.8672 7.58203C95.4609 7.14453 94.8242 6.92578 93.957 6.92578C93.2539 6.92578 92.6367 7.11328 92.1055 7.48828C91.5742 7.86328 91.1602 8.35547 90.8633 8.96484V18H88.6953V5.32031H90.7461Z"
                  />
                );
              }}
            </Spring>
          </g>
        </svg>
      </div>
    );
  }
}

export default App;
